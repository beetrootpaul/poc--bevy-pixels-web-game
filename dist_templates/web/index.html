<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- TODO: any other useful meta tags etc.? -->

    <title>Bevy/pixels web game PoC</title>

    <link data-trunk rel="rust" href="../../"/>

    <!-- TODO: copy only OGG files  -->
    <link data-trunk rel="copy-dir" href="../../assets/"/>

    <link data-trunk rel="inline" type="css" href="index.css"/>

    <!-- TODO: Do I need to specify data-wasm-opt or is the one from Cargo.toml taken into account? https://trunkrs.dev/assets/ -->
    <!-- TODO: <link data-trunk rel="copy-file" href="build/windows/icon.ico"/> <link rel="icon" href="icon.ico"> -->

    <link data-trunk rel="inline" href="../../dist_templates/web/audio_context_hack.js"/>

</head>
<body>

<canvas id="bevy_pixels_web_game_poc__canvas">
    Javascript and support for canvas is required
</canvas>

<div id="overlay_for_grabbing_initial_user_interaction"></div>

<script>
    const overlay = document.getElementById("overlay_for_grabbing_initial_user_interaction");
    function overlayEventListener(event) {
        window.__resumeAllContexts(event)

        console.log("[[[");
        console.log("- remove listeners");
        console.log("]]]");
        window.__userInputEventNames.forEach(eventName => {
            overlay.removeEventListener(eventName, overlayEventListener);
        });

        console.log("[[[");
        console.log("- remove overlay");
        console.log("]]]");
        overlay.remove();
    }

    console.log("[[[");
    console.log("+ ADD listeners");
    console.log("]]]");
    window.__userInputEventNames.forEach(eventName => {
        overlay.addEventListener(eventName, overlayEventListener);
    });
</script>

</body>
</html>
