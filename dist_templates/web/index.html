<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- TODO: any other useful meta tags etc.? -->

    <title>Bevy/pixels web game PoC</title>

    <link data-trunk rel="rust" href="../../"/>

    <!-- TODO: copy only OGG files  -->
    <link data-trunk rel="copy-dir" href="../../assets/"/>

    <link data-trunk rel="inline" type="css" href="index.css"/>

    <!-- TODO: Do I need to specify data-wasm-opt or is the one from Cargo.toml taken into account? https://trunkrs.dev/assets/ -->
    <!-- TODO: <link data-trunk rel="copy-file" href="build/windows/icon.ico"/> <link rel="icon" href="icon.ico"> -->

    <link data-trunk rel="inline" href="../../dist_templates/web/audio_context_hack.js"/>

</head>
<body id="capture_area">


<div id="overlay_for_grabbing_initial_user_interaction">
    <canvas id="bevy_pixels_web_game_poc__canvas">
        Javascript and support for canvas is required
    </canvas>
</div>

<script>
    const capturing_element = document.getElementById("overlay_for_grabbing_initial_user_interaction");
    // const capturing_element = document.getElementById("capture_area");
    // const capturing_element = document;

    function overlayEventListener(event) {
        // TODO: debounce/throttle?
        window.__resumeAllContexts(event)

        // console.log("[[[");
        // console.log("- remove listeners");
        // console.log("]]]");
        // window.__userInputEventNames.forEach(eventName => {
        //     capturing_element.removeEventListener(eventName, overlayEventListener);
        // });

        // console.log("[[[");
        // console.log("- remove overlay");
        // console.log("]]]");
        // capturing_element.remove();
    }

    console.log("[[[");
    console.log("+ add LISTENERS");
    console.log("]]]");
    window.__userInputEventNames.forEach(eventName => {
        capturing_element.addEventListener(eventName, overlayEventListener);
    });
</script>

</body>
</html>
